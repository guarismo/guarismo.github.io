---
layout: post
title: "Metasploitable 3 - OpenVAS Vulnerability Scan"
date: 2017-02-04T00:12:00Z
author: gu4r15sm0
category: metasploitable
tags: [metasploitable3, vulnerability-scanning]
---

## Metasploitable 3

### Vulnerability Scan with OpenVAS

Before this post I was exploiting vulnerabilities I found by researching the ***nmap*** results, so I decided to go a little further and run a vulnerability scanner to get a bit more info about the metasploitable3 server using the openvas module included with metasploit from the msfconsole.
As seen in the [OpenVAS website](http://www.openvas.org/about.html):

## 
*About OpenVAS*

*The Open Vulnerability Assessment System (OpenVAS) is a framework of several services and tools offering a comprehensive and powerful vulnerability scanning and vulnerability management solution.*

*The actual security scanner is accompanied with a regularly updated feed of Network Vulnerability Tests (NVTs), over 47,000 in total (as of June 2016).*

*All OpenVAS products are Free Software. Most components are licensed under the GNU General Public License (GNU GPL).*

Load the openvas module in metasploit

```bash
msf > load openvas
[\*] Welcome to OpenVAS integration by kost and averagesecurityguy.
[\*]Â 
[\*] OpenVAS integration requires a database connection. Once theÂ 
[\*] database is ready, connect to the OpenVAS server using openvas_connect.
[\*] For additional commands use openvas_help.
[\*]Â 
[\*] Successfully loaded plugin: OpenVAS
msf >Â 
Let's see what commands are available
msf > openvas_ Â <-- press 2xtab
```

openvas_config_list Â  Â  Â  Â  Â  openvas_report_delete Â  Â  Â  Â  openvas_target_list Â  Â  Â  Â  Â  openvas_task_resume_or_start
openvas_connect Â  Â  Â  Â  Â  Â  Â  openvas_report_download Â  Â  Â  openvas_task_create Â  Â  Â  Â  Â  openvas_task_start
openvas_debug Â  Â  Â  Â  Â  Â  Â  Â  openvas_report_import Â  Â  Â  Â  openvas_task_delete Â  Â  Â  Â  Â  openvas_task_stop
openvas_disconnect Â  Â  Â  Â  Â  Â openvas_report_list Â  Â  Â  Â  Â  openvas_task_list Â  Â  Â  Â  Â  Â  openvas_version
openvas_format_list Â  Â  Â  Â  Â  openvas_target_create Â  Â  Â  Â  openvas_task_pause Â  Â  Â  Â  Â  Â 
openvas_help Â  Â  Â  Â  Â  Â  Â  Â  Â openvas_target_delete Â  Â  Â  Â  openvas_task_resume Â  Â  Â  Â  Â Â 

Connect to OpenVAS from metasploit

```bash
msf > openvas_connectÂ 
[\*] Usage:
[\*] openvas_connect username password host port <ssl-confirm>
msf > openvas_connect <USER> <PASSWORD> 127.0.0.1 9390

And create a target, in this case my metasploitable3 server

msf > openvas_target_createÂ 

[\*] Usage: openvas_target_create <name> <hosts> <comment>


```bash
msf > openvas_target_create metasploitable3 10.20.10.23 "Metasploitable 3"

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```


[\*]Â 

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

[+] OpenVAS list of targets
```


ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Â  Hosts Â  Â  Â  Â Max Hosts Â In Use Â Comment

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  Â  ----- Â  Â  Â  Â --------- Â ------ Â -------

**66d42758-5aec-40c6-91cc-647e9bc27734 Â metasploitable3 Â 10.20.10.23 Â 1 Â  Â  Â  Â  Â 1 Â  Â  Â  Metasploitable 3**

b493b7a8-7489-11df-a3ec-002264764cea Â Localhost Â  Â  Â  Â localhost Â  Â 1 Â  Â  Â  Â  Â 0 Â Â 

OpenVAS has different types of Scans predefined available depending on the purpose of the scan there are someÂ Network Vulnerability Tests (NVTs) enabled
**empty**: Empty and static configuration template.
**Discovery**: Network Discovery scan configuration.
**Full and fast**: Most NVT's; optimized by using previously collected information.
**Full and fast ultimate**: Most NVT's including those that can stop services/hosts; optimized by using previously collected information.
**Full and very deep**: Most NVT's; don't trust previously collected information; slow.
**Full and very deep ultimate**: Most NVT's including those that can stop services/hosts; don't trust previously collected information; slow.
**Host Discovery**: Network Host Discovery scan configuration.
**System Discovery**: Network System Discovery scan configuration.

```bash
msf > openvas_config_list
/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
[+] OpenVAS list of configs
ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name
\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ----
085569ce-73ed-11df-83c3-002264764cea Â empty
2d3f051c-55ba-11e3-bf43-406186ea4fc5 Â Host Discovery
698f691e-7489-11df-9d8c-002264764cea Â Full and fast ultimate
708f25c4-7489-11df-8094-002264764cea Â Full and very deep
74db13d6-7489-11df-91b9-002264764cea Â Full and very deep ultimate
8715c877-47a0-438d-98a3-27c7a6ab2196 Â Discovery
bbca7412-a950-11e3-9109-406186ea4fc5 Â System Discovery
daba56c8-73ec-11df-a475-002264764cea Â Full and fast
```

Since I'm not scared of being blocked or detected by an IDS or anything, I chose the ***Full and very deep ultimate*** scan to create my scanning task

```bash
msf > openvas_task_createÂ 
[\*] Usage: openvas_task_create <name> <comment> <config_id> <target_id>

msf > openvas_task_create metasploitable3 "Full and very deep ultimate" 74db13d6-7489-11df-91b9-002264764cea 66d42758-5aec-40c6-91cc-647e9bc27734

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
[\*] 488384b9-2e40-4ea4-8c43-bfe978440280
/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
[+] OpenVAS list of tasks
```

ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Â  Comment Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Status Â Progress
\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  Â  ------- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ------ Â --------
488384b9-2e40-4ea4-8c43-bfe978440280 Â metasploitable3 Â Full and very deep ultimate Â New Â  Â  -1

And I run my new task:


```bash
msf > openvas_task_start 488384b9-2e40-4ea4-8c43-bfe978440280

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```
```


[\*] <X><authenticate_response status='200' status_text='OK'><role>Admin</role><timezone>UTC</timezone><severity>nist</severity></authenticate_response><start_task_response status='202' status_text='OK, request submitted'><report_id>b1ebe60c-577e-4cdb-8ead-4d09e6474835</report_id></start_task_response></X>

And wait...


```bash
msf > openvas_task_list

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```


[+] OpenVAS list of tasks
```


ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Â  Comment Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Status Â  Progress

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  Â  ------- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ------ Â  --------

488384b9-2e40-4ea4-8c43-bfe978440280 Â metasploitable3 Â Full and very deep ultimate Â **Running** Â **1**


```bash
msf > openvas_task_list

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```


[+] OpenVAS list of tasks
```


ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Â  Comment Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Status Â  Progress

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  Â  ------- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ------ Â  --------

488384b9-2e40-4ea4-8c43-bfe978440280 Â metasploitable3 Â Full and very deep ultimate Â **Running** Â **4**

With access to the Greenbone (the Web GUI for OpenVAS, usually running in TCP port 9392) I can also follow the progress of the task.

[![](/assets/images/openvas-vulnscan.jpg)](/assets/images/openvas-vulnscan.jpg)

Task Progress in Greenbone for OpenVAS

At 98% of progress we can see very interesting results, including a few vulnerabilities I exploited before

[![](/assets/images/openvas-vulnscan-98percent.jpg)](/assets/images/openvas-vulnscan-98percent.jpg)

98% Scan Progress

And we're done...

```bash
msf > openvas_task_list
/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```

[+] OpenVAS list of tasks
```

ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Â  Comment Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Status Â Progress
\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  Â  ------- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ------ Â --------
488384b9-2e40-4ea4-8c43-bfe978440280 Â metasploitable3 Â Full and very deep ultimate Â **Done** Â  Â **\-1**

Now I import the report into metasploit to populate my vulns table.

OpenVAS supports different report formats and we need to know the ID of the format we want to use, in this case XML because is the one of the format supported


```bash
msf > openvas_format_listÂ 

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```


[+] OpenVAS list of report formats

ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Name Â  Â  Â  Â  Â  Extension Â Summary

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â ---- Â  Â  Â  Â  Â  --------- Â -------
```


5057e5cc-b825-11e4-9d0e-28d24461215b Â Anonymous XML Â xml Â  Â  Â  Â Anonymous version of the raw XML report

50c9950a-f326-11e4-800c-28d24461215b Â Verinice ITG Â  vna Â  Â  Â  Â Greenbone Verinice ITG Report, v1.0.1.

5ceff8ba-1f62-11e1-ab9f-406186ea4fc5 Â CPE Â  Â  Â  Â  Â  Â csv Â  Â  Â  Â Common Product Enumeration CSV table.

6c248850-1f62-11e1-b082-406186ea4fc5 Â HTML Â  Â  Â  Â  Â  html Â  Â  Â  Single page HTML report.

77bd6c4a-1f62-11e1-abf0-406186ea4fc5 Â ITG Â  Â  Â  Â  Â  Â csv Â  Â  Â  Â German "IT-Grundschutz-Kataloge" report.

9087b18c-626c-11e3-8892-406186ea4fc5 Â CSV Hosts Â  Â  Â csv Â  Â  Â  Â CSV host summary.

910200ca-dc05-11e1-954f-406186ea4fc5 Â ARF Â  Â  Â  Â  Â  Â xml Â  Â  Â  Â Asset Reporting Format v1.0.0.

9ca6fe72-1f62-11e1-9e7c-406186ea4fc5 Â NBE Â  Â  Â  Â  Â  Â nbe Â  Â  Â  Â Legacy OpenVAS report.

9e5e5deb-879e-4ecc-8be6-a71cd0875cdd Â Topology SVG Â  svg Â  Â  Â  Â Network topology SVG image.

a3810a62-1f62-11e1-9219-406186ea4fc5 Â TXT Â  Â  Â  Â  Â  Â txt Â  Â  Â  Â Plain text report.

a684c02c-b531-11e1-bdc2-406186ea4fc5 Â LaTeX Â  Â  Â  Â  Â tex Â  Â  Â  Â LaTeX source file.

a994b278-1f62-11e1-96ac-406186ea4fc5 Â XML Â  Â  Â  Â  Â  Â xml Â  Â  Â  Â Raw XML report.

c15ad349-bd8d-457a-880a-c7056532ee15 Â Verinice ISM Â  vna Â  Â  Â  Â Greenbone Verinice ISM Report, v1.1.10.

c1645568-627a-11e3-a660-406186ea4fc5 Â CSV Results Â  Â csv Â  Â  Â  Â CSV result list.

c402cc3e-b531-11e1-9163-406186ea4fc5 Â PDF Â  Â  Â  Â  Â  Â pdf Â  Â  Â  Â Portable Document Format report.


```bash
msf > openvas_report_importÂ 

[\*] Usage: openvas_report_import <report_id> <format_id>

[\*] Only the NBE and XML formats are supported for importing.

msf > openvas_report_list

[+] OpenVAS list of reports
```


ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Task Name Â  Â  Â  Â Start Time Â  Â  Â  Â  Â  Â Stop Time

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â --------- Â  Â  Â  Â ---------- Â  Â  Â  Â  Â  Â ---------

b1ebe60c-577e-4cdb-8ead-4d09e6474835 Â metasploitable3 Â 2017-02-01T03:59:09Z Â 2017-02-01T04:26:37Z

And I got an error... ðŸ‘Ž, It seems the [openvas-omp](https://rubygems.org/gems/openvas-omp/) Â Ruby gem hasn't been updated since 2011 ðŸ˜£Â 


```bash
msf > openvas_report_import b1ebe60c-577e-4cdb-8ead-4d09e6474835 a994b278-1f62-11e1-96ac-406186ea4fc5

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb:201:in \`sendrecv': Object#timeout is deprecated, use Timeout.timeout instead.
```


[\*] Importing report to database.
```


[-] Error while running command openvas_report_import: undefined method \`split' for nil:NilClass

Call stack:


```text
/usr/share/metasploit-framework/lib/rex/parser/openvas_nokogiri.rb:100:in \`end_element'

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/nokogiri-1.7.0.1/lib/nokogiri/xml/sax/document.rb:127:in \`end_element_namespace'

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/nokogiri-1.7.0.1/lib/nokogiri/xml/sax/parser.rb:112:in \`parse_with'

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/nokogiri-1.7.0.1/lib/nokogiri/xml/sax/parser.rb:112:in \`parse_memory'

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/nokogiri-1.7.0.1/lib/nokogiri/xml/sax/parser.rb:84:in \`parse'

/usr/share/metasploit-framework/lib/msf/core/db_manager/import/open_vas.rb:11:in \`import_openvas_new_xml'

/usr/share/metasploit-framework/lib/msf/core/db_manager/import.rb:95:in \`import'

/usr/share/metasploit-framework/plugins/openvas.rb:529:in \`cmd_openvas_report_import'

/usr/share/metasploit-framework/lib/rex/ui/text/dispatcher_shell.rb:430:in \`run_command'

/usr/share/metasploit-framework/lib/rex/ui/text/dispatcher_shell.rb:392:in \`block in run_single'

/usr/share/metasploit-framework/lib/rex/ui/text/dispatcher_shell.rb:386:in \`each'

/usr/share/metasploit-framework/lib/rex/ui/text/dispatcher_shell.rb:386:in \`run_single'

/usr/share/metasploit-framework/lib/rex/ui/text/shell.rb:205:in \`run'

/usr/share/metasploit-framework/lib/metasploit/framework/command/console.rb:48:in \`start'

/usr/share/metasploit-framework/lib/metasploit/framework/command/base.rb:82:in \`start'

/usr/bin/msfconsole:48:in \`<main>'
```


The first part is just that annoying 'deprecated' message I've been getting, that's an easy fix, just editÂ 

/usr/share/metasploit-framework/vendor/bundle/ruby/2.3.0/gems/openvas-omp-0.0.4/lib/openvas-omp.rb

go to line 201 and replace timeout with Timeout.timeout

[![](/assets/images/openvas-omp-patch-line201.jpg)](/assets/images/openvas-omp-patch-line201.jpg)

Replace timeout with Timeout.timeout

The other seems to be a real problem, the db_import functionality is not able to import my OpenVAS XML report, might be something wrong with my report or a bug in db_import or how the split is used inÂ /usr/share/metasploit-framework/lib/rex/parser/openvas_nokogiri.rb:100

[![](/assets/images/openvas_nokogiri_split.jpg)](/assets/images/openvas_nokogiri_split.jpg)

It breaks at line 100

I've open an issue in [GitHub](https://github.com/rapid7/metasploit-framework/issues/7903) for now.

But no worries, we can still import an old report I had that worked well but didn't catch all the vulns


```bash
msf > openvas_report_list

[+] OpenVAS list of reports
```


ID Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Task Name Â  Â  Â  Â Start Time Â  Â  Â  Â  Â  Â Stop Time

\-- Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â --------- Â  Â  Â  Â ---------- Â  Â  Â  Â  Â  Â ---------

**0a8443d2-a8f3-4ae3-a905-8a2f8329e266** Â metasploitable3 Â 2017-01-31T03:42:32Z Â 2017-01-31T04:25:38Z

b1ebe60c-577e-4cdb-8ead-4d09e6474835 Â metasploitable3 Â 2017-02-01T03:59:09Z Â 2017-02-01T04:26:37Z


```bash
msf > openvas_report_import 0a8443d2-a8f3-4ae3-a905-8a2f8329e266 a994b278-1f62-11e1-96ac-406186ea4fc5

[\*] Importing report to database.

And my workspace is now populated:

msf > hosts

Hosts

\=====

address Â  Â  Â mac Â name Â os_name Â os_flavor Â os_sp Â purpose Â info Â comments

------- Â  Â  Â --- Â ---- Â ------- Â --------- Â ----- Â ------- Â ---- Â --------

10.20.10.23 Â  Â  Â  Â  Â  Â  Unknown Â  Â  Â  Â  Â  Â  Â  Â  Â  Â device Â  Â  Â  Â Â 

msf > servicesÂ 

Services

========

host Â  Â  Â  Â  port Â proto Â name Â state Â info

---- Â  Â  Â  Â  ---- Â ----- Â ---- Â ----- Â ----


10.20.10.23 Â 21 Â  Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 22 Â  Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 80 Â  Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 1617 Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 4848 Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 8022 Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 8080 Â tcp Â  Â  Â  Â  Â open Â Â 

10.20.10.23 Â 9200 Â tcp Â  Â  Â  Â  Â open Â Â 
```


**msf**Â > vulns

[\*]Â Time: 2017-02-03 06:07:40 UTC Vuln: host=10.20.10.23 name=Microsoft Windows IIS FTP Server DOS Vulnerability refs=CVE-2010-3972,BID-45542Â 

[\*]Â Time: 2017-02-03 06:07:40 UTC Vuln: host=10.20.10.23 name=MS15-034 HTTP.sys Remote Code Execution Vulnerability (remote check) refs=CVE-2015-1635Â 

[\*]Â Time: 2017-02-03 06:07:40 UTC Vuln: host=10.20.10.23 name=Elastisearch Remote Code Execution Vulnerability refs=CVE-2014-3120Â 

Unfortunately this import is not as good as the nmap one I did before.

Next time I will do the same with Nessus Free and another one with Nextpose Community.