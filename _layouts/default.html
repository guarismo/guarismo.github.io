<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  {% seo %}
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
</head>
<body>

  {% include nav-drawer.html %}

  <div class="topbar" id="topbar">
    <button class="hamburger" id="hamburger" aria-label="Open menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
    <a class="topbar-title" href="{{ '/' | relative_url }}">{{ site.title }}</a>
  </div>

  {% if page.url == "/" %}
    {% include hero.html %}
  {% endif %}

  <div class="main-content" id="main-content">
    {% unless page.url == "/" %}
    <header class="page-header">
      <h1>{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}</h1>
      {% if site.description and page.url == "/" %}<p class="project-tagline">{{ site.description }}</p>{% endif %}
    </header>
    {% endunless %}

    <main class="main-body">
      {{ content }}
    </main>

    <footer class="site-footer">
      <span class="site-footer-credits">
        {{ site.title }} &mdash; Powered by <a href="https://pages.github.com">GitHub Pages</a>
      </span>
    </footer>
  </div>

  <script>
  // Drawer toggle
  const hamburger = document.getElementById('hamburger');
  const drawer = document.getElementById('nav-drawer');
  const overlay = document.getElementById('drawer-overlay');
  const drawerClose = document.getElementById('drawer-close');

  function openDrawer() {
    drawer.classList.add('open');
    overlay.classList.add('open');
    document.body.classList.add('drawer-open');
  }

  function closeDrawer() {
    drawer.classList.remove('open');
    overlay.classList.remove('open');
    document.body.classList.remove('drawer-open');
  }

  if (hamburger) hamburger.addEventListener('click', openDrawer);
  if (overlay) overlay.addEventListener('click', closeDrawer);
  if (drawerClose) drawerClose.addEventListener('click', closeDrawer);

  // Collapsible menu â€” both top-level toggles and sub-toggles
  function handleToggle(el, e) {
    e.preventDefault();
    const targetId = 'nav-' + el.dataset.toggle;
    const target = document.getElementById(targetId);
    const arrow = el.querySelector('.nav-arrow');

    if (target) {
      target.classList.toggle('expanded');
      if (arrow) arrow.classList.toggle('expanded');

      const state = JSON.parse(localStorage.getItem('navState') || '{}');
      state[targetId] = target.classList.contains('expanded');
      localStorage.setItem('navState', JSON.stringify(state));
    }
  }

  document.querySelectorAll('.nav-toggle').forEach(function(toggle) {
    toggle.addEventListener('click', function(e) { handleToggle(this, e); });
  });

  document.querySelectorAll('.nav-sub-toggle').forEach(function(btn) {
    btn.addEventListener('click', function(e) { handleToggle(this, e); });
  });

  // Restore state
  const savedState = JSON.parse(localStorage.getItem('navState') || '{}');
  Object.keys(savedState).forEach(function(id) {
    if (savedState[id]) {
      const el = document.getElementById(id);
      if (el) {
        el.classList.add('expanded');
        const toggle = document.querySelector('[data-toggle="' + id.replace('nav-', '') + '"]');
        if (toggle) {
          const arrow = toggle.querySelector('.nav-arrow');
          if (arrow) arrow.classList.add('expanded');
        }
      }
    }
  });
  </script>

</body>
</html>
